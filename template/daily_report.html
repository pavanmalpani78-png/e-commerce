<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Daily Milk Report</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: #f5f7fb;
        }

        .page-wrap {
            max-width: 1050px;
            margin: 28px auto;
        }

        .card-pro {
            border: 0;
            border-radius: 18px;
            box-shadow: 0 12px 30px rgba(20, 40, 80, 0.08);
            overflow: hidden;
        }

        .topbar {
            background: linear-gradient(135deg, #0d6efd, #2193b0);
            color: white;
            padding: 22px 24px;
        }

        .topbar h3 {
            margin: 0;
            font-weight: 800;
            letter-spacing: 0.2px;
        }

        .topbar p {
            margin: 6px 0 0;
            opacity: 0.9;
        }

        .btn-pill {
            border-radius: 12px;
            padding: 10px 14px;
            font-weight: 600;
        }

        .searchbox {
            border-radius: 12px;
            padding: 11px 12px;
            border: 1px solid #e5e7eb;
        }

        .table thead th {
            background: #0b1220 !important;
            color: #fff !important;
            border-color: #0b1220 !important;
        }

        .table tbody tr:hover {
            background: #f2f6ff;
            transition: 0.2s;
        }

        .badge-soft {
            border-radius: 999px;
            padding: 6px 10px;
            font-weight: 700;
            font-size: 12px;
            display: inline-block;
        }

        .muted {
            color: #6b7280;
        }
    </style>
</head>

<body>

    {% include 'navbar.html' %}

    <div class="page-wrap">

        <div class="card card-pro">
            <!-- Header -->
            <div
                class="topbar d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-3">
                <div>
                    <h3>Daily Milk Report</h3>
                    <p>View milk orders summary date-wise</p>
                </div>

                <div class="d-flex gap-2">
                    <a href="{% url 'milk_order' %}" class="btn btn-light btn-pill">Back to Orders</a>
                </div>
            </div>

            <!-- Content -->
            <div class="p-3 p-md-4">

                <!-- Date Filter -->
                <form method="GET" class="row g-2 align-items-end mb-3">
                    <div class="col-12 col-md-4">
                        <label class="form-label muted">Select Date</label>
                        <input type="date" name="date" class="form-control searchbox" value="{{ selected_date }}">
                    </div>
                    <div class="col-12 col-md-auto">
                        <button class="btn btn-primary btn-pill">View</button>
                    </div>
                </form>

                <!-- Totals -->
                <div class="d-flex flex-wrap gap-2 mb-3">
                    <span class="badge-soft" style="background:#ecfdf5;color:#047857;border:1px solid #a7f3d0;">
                        Total Liters: {{ totals.total_liters|default:0 }}
                    </span>

                    <span class="badge-soft" style="background:#eef2ff;color:#1d4ed8;border:1px solid #dbeafe;">
                        Total Amount: ₹ {{ totals.total_amount|default:0 }}
                    </span>

                    <span class="badge-soft" style="background:#fff7ed;color:#9a3412;border:1px solid #fed7aa;">
                        Records: {{ orders|length }}
                    </span>
                </div>

                <!-- Search -->
                <div
                    class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-2 mb-3">
                    <div class="muted">
                        Filter by customer / brand / pack...
                    </div>

                    <input id="searchInput" type="text" class="form-control searchbox" style="max-width:340px;"
                        placeholder="Search in report...">
                </div>

                <!-- Table -->
                <div class="table-responsive">
                    <table class="table table-bordered align-middle mb-0" id="reportTable">
                        <thead>
                            <tr>
                                <th style="width: 16%;">Date</th>
                                <th style="width: 22%;">Customer</th>
                                <th style="width: 14%;">Brand</th>
                                <th style="width: 12%;">Milk Type</th>
                                <th style="width: 10%;">Pack</th>
                                <th style="width: 10%;">Packets</th>
                                <th style="width: 10%;">Liters</th>
                                <th style="width: 12%;">Total (₹)</th>
                            </tr>
                        </thead>

                        <tbody>
                            {% for o in orders %}
                            <tr>
                                <td>{{ o.date }}</td>
                                <td class="fw-semibold">{{ o.customer.name }}</td>
                                <td>{{ o.get_brand_display|default:"-" }}</td>
                                <td>{{ o.get_milk_type_display|default:"-" }}</td>
                                <td>{{ o.pack_size|default:"-" }}</td>
                                <td>{{ o.packets|default:"-" }}</td>
                                <td>{{ o.total_liters|default:0 }}</td>
                                <td class="fw-bold">₹ {{ o.total|default:0 }}</td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="8" class="text-center muted py-4">
                                    No records found for this date.
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>

                    </table>
                </div>

            </div>
        </div>

        <div class="text-center muted small mt-3">
            © 2026 Milk Khata • Daily Report
        </div>

    </div>

    <script>
        const searchInput = document.getElementById("searchInput");
        const table = document.getElementById("reportTable");
        const rows = table.querySelectorAll("tbody tr");

        searchInput.addEventListener("keyup", function () {
            const q = this.value.toLowerCase().trim();
            rows.forEach(row => {
                const text = row.innerText.toLowerCase();
                row.style.display = text.includes(q) ? "" : "none";
            });
        });
    </script>

</body>

</html>